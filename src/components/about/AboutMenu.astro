---
import "./about.css";
import type { StoreValue } from "nanostores";
import { activeAboutItem } from "src/data/store.ts";
const { data } = Astro.props;
type StoreType = StoreValue<typeof data>;
type data = {
  id: "Title.mdx";
  slug: "title";
  body: "\nBody\n";
  collection: "about";
  data: { title: "Title"; snippet: "Snippet"; menu_label: "Menu Label" };
  render: unknown; //[AsyncFunction: render];
}[];
---

<div class="about-menu">
  <!-- MENU -->
  <div class="flex flex-inline gap-2 h-fit mt-8">
    <ul class="">
      {
        data.map((d, idx) => (
          <li
            data-slug={d.slug}
            data-idx={idx}
            class={`about__menu__item  text-gray-600
            ${activeAboutItem.get() === idx ? "menu-active" : ""}
            transition-all duration-200 ease-out
            hover:text-black
            hover:cursor-pointer
            w-fit
            `}
          >
            {d.data.menu_label}
          </li>
        ))
      }
    </ul>
    <div class="border-r border-black"></div>
  </div>
</div>

<script lang="ts" type="module">
  import { activeAboutItem } from "/src/data/store.ts";

  const menuItems = document.querySelectorAll(".about__menu__item");

  // Listen to changes in the activeAboutItem store
  activeAboutItem.listen((value) => {
    menuItems.forEach((item, idx) => {
      item.classList.remove("menu-active");
      if (idx === value) {
        item.classList.add("menu-active");
        console.log("index", idx, "set as active");
        console.log("store reflects as ", activeAboutItem.get());
      }
    });
  });

  // Add click event listeners to menu items
  menuItems.forEach((item, idx) => {
    item.addEventListener("click", () => {
      if (!item.classList.contains("menu-active")) {
        activeAboutItem.set(idx);
      }
    });
  });
</script>
